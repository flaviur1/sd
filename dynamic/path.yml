http:
  # Define URL routing rules, middlewares, and services
  routers:
    user-swagger-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/users/user-swag`)"
      entryPoints:
        - web
      middlewares:
        - strip-api-prefix-swg
      service: user-microservice-swg
      priority: 101

    device-swagger-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/devices/device-swag`)"
      entryPoints:
        - web
      middlewares:
        - strip-api-prefix-swg
      service: device-microservice-swg
      priority: 101

    auth-swagger-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/auth/auth-swag`)"
      entryPoints:
        - web
      middlewares:
        - strip-api-prefix-swg
      service: auth-microservice-swg
      priority: 101

    user-microservice-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/users`)"
      entryPoints:
        - web
      middlewares:
        - forward-auth
        - strip-api-prefix
      service: user-microservice
      priority: 150

    device-microservice-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/devices`) || PathPrefix(`/api/device-user`)"
      entryPoints:
        - web
      middlewares:
        - forward-auth
        - strip-api-prefix
      service: device-microservice
      priority: 150

    auth-microservice-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/auth`)"
      entryPoints:
        - web
      middlewares:
        - strip-api-prefix
      service: auth-microservice
      priority: 150

    monitoring-microservice-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/monitor`)"
      entryPoints:
        - web
      middlewares:
        - forward-auth
        - strip-api-prefix
      service: monitoring-microservice
      priority: 150

    frontend-router:
      rule: "Host(`localhost`) && PathPrefix(`/`)"
      entryPoints:
        - web
      service: frontend-service
      priority: 100

  middlewares:
    forward-auth:
      forwardAuth:
        address: "http://auth-microservice:8080/auth/validate"
        authResponseHeaders:
          - "UserId"
          - "UserRoles"
    strip-api-prefix: # Middleware to remove /api prefix
      stripPrefix:
        prefixes:
          - "/api"
    strip-api-prefix-swg: # Middleware to remove /api prefix
      stripPrefix:
        prefixes:
          - "/api/users"
          - "/api/devices"
          - "/api/auth"
  #    auth-basic: # Middleware for basic authentication
  #      basicAuth:
  #        users:
  #          - "user:$apr1$H6uskkkW$IgXLP6ewTrSuBkTrqE8wj/" # password = "test"
  # pune un middleware de redirect catre validate din auth, sterge filtrele si security config din microserviici
  services:
    user-microservice:
      loadBalancer:
        servers:
          - url: "http://user-microservice:8080"
    user-microservice-swg:
      loadBalancer:
        servers:
          - url: "http://user-microservice:8080"

    device-microservice:
      loadBalancer:
        servers:
          - url: "http://device-microservice:8080"
    device-microservice-swg:
      loadBalancer:
        servers:
          - url: "http://device-microservice:8080"

    auth-microservice:
      loadBalancer:
        servers:
          - url: "http://auth-microservice:8080"
    auth-microservice-swg:
      loadBalancer:
        servers:
          - url: "http://auth-microservice:8080"

    monitoring-microservice:
      loadBalancer:
        servers:
          - url: "http://monitoring-microservice:8080"

    frontend-service:
      loadBalancer:
        servers:
          - url: "http://frontend:80"