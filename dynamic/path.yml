http:
  # Define URL routing rules, middlewares, and services
  routers:
    user-microservice-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/users`)"
      entryPoints:
        - web
      middlewares:
        - strip-api-prefix
      service: user_microservice

    device-microservice-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/devices`)"
      entryPoints:
        - web
      middlewares:
        - strip-api-prefix
      service: device_microservice

    auth-microservice-router:
      rule: "Host(`localhost`) && PathPrefix(`/api/auth`)"
      entryPoints:
        - web
      middlewares:
        - strip-api-prefix
      service: auth_microservice

    frontend-router:
      rule: "Host(`localhost`) && PathPrefix(`/`)"
      entryPoints:
        - web
      service: frontend_microservice

  middlewares:
    strip-api-prefix: # Middleware to remove /api prefix
      stripPrefix:
        prefixes:
          - "/api"

  #    auth-basic: # Middleware for basic authentication
  #      basicAuth:
  #        users:
  #          - "user:$apr1$H6uskkkW$IgXLP6ewTrSuBkTrqE8wj/" # password = "test"

  services:
    user_microservice:
      loadBalancer:
        servers:
          - url: "http://user_microservice:8080"

    device_microservice:
      loadBalancer:
        servers:
          - url: "http://device_microservice:8080"

    auth_microservice:
      loadBalancer:
        servers:
          - url: "http://auth_microservice:8080"

    frontend_microservice:
      loadBalancer:
        servers:
          - url: "http://frontend:80"